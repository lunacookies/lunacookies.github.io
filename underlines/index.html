<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>A Little Hack for Nicer Underlines in CSS · Luna’s Website</title><link rel=stylesheet href=https://arzg.github.io/scss/main.f098d603f7422c3cea329b58a63eb40d741cc405b37328f8fd6e2df6f62a2d1d.css integrity="sha256-8JjWA/dCLDzqMptYpj60DXQcxAWzcyj4/W4t9vYqLR0="><link rel=stylesheet href=https://use.typekit.net/kzs1kza.css><script src=https://unpkg.com/prismjs@1.25.0/components/prism-core.min.js></script>
<script src=https://unpkg.com/prismjs@1.25.0/plugins/autoloader/prism-autoloader.min.js></script></head><body><nav><a href=https://arzg.github.io/>home</a></nav><header><h1>A Little Hack for Nicer Underlines in CSS</h1><p class=subtitle>It’s not too bad, I promise&emsp;•&emsp;7 October 2022</p></header><p><code>text-decoration: underline</code> looks <span style=text-decoration:underline>like this</span>.
To my eyes, the underline is too thick
and too close to the text.
How could we create our own custom underline using CSS?</p><h2 id=the-basic-idea>The basic idea</h2><p>We can try creating a colored background
behind the text we wish to underline,
then resize and position it so it:</p><ul><li>is one pixel tall</li><li>spans the width of the text</li><li>is positioned just above the very bottom edge of the text</li></ul><pre><code class=language-css>.underlined {
  background-color: currentColor;
  background-repeat: no-repeat;
  background-size: 100% 1px;
  background-position: 0 87%;
}
</code></pre><p>This doesn’t work, since it isn’t possible
to adjust the size and position
of a background created with <code>background-color</code>.
Instead, we can use a little hack
to circumvent this limitation:</p><pre><code class=language-css>.underlined {
  background-image: linear-gradient(currentColor, currentColor);
  background-repeat: no-repeat;
  background-size: 100% 1px;
  background-position: 0 87%;
}
</code></pre><p>We create a gradient which both starts and finishes
at the text’s current color;
this functions identically to the <code>background-color</code> property,
except that it lets us resize and reposition the background.</p><p><span style="background-image:linear-gradient(currentColor,currentColor);background-size:100% 1px;background-repeat:no-repeat;background-position:0 87%">Much better.</span></p><p>And here, enlarged for your viewing pleasure:</p><p><span style=font-size:2rem;line-height:1;text-decoration:underline>lorem ipsum</span></p><p><span style="font-size:2rem;line-height:1;background-image:linear-gradient(currentColor,currentColor);background-size:100% 2px;background-repeat:no-repeat;background-position:0 87%">lorem ipsum</span></p><p>(Note that I manually increased the underline thickness
to compensate for the larger font size.)</p><p>This technique works consistently across all browsers,
is highly customizable to your liking,
doesn’t require any spottily-supported CSS features
and functions correctly when the underlined text
is broken across multiple lines.</p><h2 id=avoiding-descenders>Avoiding descenders</h2><p>One downside of this approach
is that it doesn’t avoid descenders
like <code>text-decoration: underline</code> does in some browsers.
It <em>is</em> possible to remedy this
through an obscene number of <code>text-shadow</code>s,
but this often leads to slow and sometimes outright buggy
rendering by the browser,
which in turn leads to more hacks around making
the shadows disappear when the text is selected.</p><p>Regrettably, I couldn’t resist not doing this
when I made my
<a href=https://arzg.github.io/lang>Make A Language</a> tutorial series.
To give you an idea of what’s involved,
I’ve reproduced an edited version of the code
necessary for implementing this below.
I won’t go into the details though,
since frankly this is just Not A Good Idea.</p><pre><code class=language-scss>// Note: this is SCSS, not CSS

@mixin text-shadow($background) {
  $shadows: ();

  @for $x from -3 through 3 {
    @for $y from -2 through 2 {
      // A shadow at 0px, 0px has no effect, so we omit it.
      @if not($x==0 and $y==0) {
        $shadows: append(
          $shadows,
          unquote(&quot;#{$x}px #{$y}px #{$background}&quot;),
          $separator: comma
        );
      }
    }
  }

  text-shadow: $shadows;
}

a {
  background-size: 100% 1px;
  background-position: 0 100%;

  background-image: linear-gradient($light-faded, $light-faded);
  @include text-shadow($light-bg);
  @media (prefers-color-scheme: dark) {
    background-image: linear-gradient($dark-faded, $dark-faded);
    @include text-shadow($dark-bg);
  }
}

// Match color of links’ text shadow when selected to the selection color.
::selection {
  @include text-shadow($light-selection);

  // Selection backgrounds in dark mode have a reduced opacity, so the color we
  // pick won’t match the actual background color of the selection. The best
  // option here is to just disable the text shadow.
  @media (prefers-color-scheme: dark) {
    text-shadow: none;
  }
}
</code></pre><p>Even with all this effort,
the text shadows still don’t render <em>quite right</em>
when you select a portion of some underlined text:</p><video autoplay muted loop playsinline src=/text-shadows.mp4></video><blockquote><p>Edit: I couldn’t resist adding the text shadows to this website
after all :)</p></blockquote></body></html>